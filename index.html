<!DOCTYPE html>





<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.3.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.3.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    search: {
      root: '/',
      path: ''
    },
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    }
  };
</script>

  <meta name="description" content="Do one thing at a time, and do well.">
<meta property="og:type" content="website">
<meta property="og:title" content="Noob">
<meta property="og:url" content="http://jeffzzf.github.io/index.html">
<meta property="og:site_name" content="Noob">
<meta property="og:description" content="Do one thing at a time, and do well.">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Noob">
<meta name="twitter:description" content="Do one thing at a time, and do well.">
  <link rel="canonical" href="http://jeffzzf.github.io/">


<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Noob</title>
  








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Noob</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
    <ul id="menu" class="menu">
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
    </ul>
    

</nav>

</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2020/05/15/《领域驱动设计：软件核心复杂性应对之道》笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/05/15/《领域驱动设计：软件核心复杂性应对之道》笔记/" class="post-title-link" itemprop="url">《领域驱动设计：软件核心复杂性应对之道》笔记</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-05-15 13:12:00" itemprop="dateCreated datePublished" datetime="2020-05-15T13:12:00+08:00">2020-05-15</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-05-16 17:44:27" itemprop="dateModified" datetime="2020-05-16T17:44:27+08:00">2020-05-16</time>
              </span>
            
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <p>领域驱动设计应对复杂问题的思想可以归类为：分治、抽象和知识。</p>
<p><strong>分治：</strong> 把问题空间分割为规模更小且易于处理的若干子问题。分割后的问题需要足够小，而且具有边界。</p>
<p><strong>抽象</strong>：对业务进行高度的归纳概括，对具体场景总结提炼，提取出关键的特征。</p>
<p><strong>知识：</strong> 模型是对知识的提炼与转换，领域驱动中设计的模型本身是具备业务含义的。</p>
<h3 id="通用语言"><a href="#通用语言" class="headerlink" title="通用语言"></a>通用语言</h3><p>通用语言是团队，包括产品、开发、测试共享的语言。由于通用语言最初来自业务方或者产品，在技术人员评审的过程中，产生分歧是难免的，这需要反复沟通来确认是否达成了共识。通用语言不仅仅是领域驱动设计开发的基础，也是软件开发的基础。通用语言不仅仅是词汇表，它要表达具体的业务场景，以及该场景的意图以及价值。<strong>通用语言形成是开发和产品不断的基于业务的目标和价值来挖掘业务场景，并将其准确表达出来的过程</strong>。</p>
<h3 id="领域"><a href="#领域" class="headerlink" title="领域"></a>领域</h3><p><strong>领域</strong>具体指一种特定的<strong>范围</strong>或区域。<strong>领域是用来确定范围的，范围即边界</strong>。在研究和解决业务问题时，领域驱动设计会按照一定的规则将业务领域进行细分，当领域细分到一定的程度后，领域驱动设计会将问题范围限定在特定的边界内，在这个边界内建立领域模型，进而用代码实现该领域模型，解决相应的业务问题。一个大的领域可以先划分为子领域，我们把划分出来的多个子领域称为子域，每个子域对应一个更小的问题域或更小的业务范围。领域建模的核心思想就<strong>是将问题域逐步分解</strong>，降低业务理解和系统实现的复杂度。</p>
<p>通过子域划分，根据不同子域对业务的不同功能属性和重要性可以区分为核心域、支撑域和通用域。对于核心域，是业务成功的主要促成因素；支撑域是相对于通用域来说的，某些领域不能通用而需要定制化，这样的领域被称为支撑域。如果一个领域能够应用于整个业务系统便是通用子域。以打车软件为例，它的核心域应该是连接距离最近的用户和司机，而软件中的地图系统则为通用域，地图系统可以使用腾讯地图提供的开放接口；而对于腾讯地图来说，地图系统则是他们的核心域。</p>
<p><strong>限界上下文是一个显式的边界，领域模型便存在于这个边界之内</strong>。领域模型把通用语言表达成软件模型。创建边界的原因在于：每一个模型概念，包括它的属性和方法，在边界之内都具有特殊含义，而在另一个边界里面可能表达不同的含义。</p>
<h3 id="LAYERED-ARCHITECTURE-（分层架构）"><a href="#LAYERED-ARCHITECTURE-（分层架构）" class="headerlink" title="LAYERED ARCHITECTURE （分层架构）"></a>LAYERED ARCHITECTURE （分层架构）</h3><p>给复杂的应用程序划分层次。在每一层内分别进行设计，使其具有内聚性并且只依赖于 它的下层。采用标准的架构模式，只与上层进行松散的耦合。将所有与领域模型相关的代码 放在一个层中，并把它与用户界面层、应用层以及基础设施层的代码分开。领域对象应该将 重点放在如何表达领域模型上，而不需要考虑自己的显示和存储问题，也无需管理应用任务 等内容。这使得模型的含义足够丰富，结构足够清晰，可以捕捉到基本的业务知识，并有效 地使用这些知识。 </p>
<p>如果一个架构能够把那些与领域相关的代码隔离出来，得到一个内聚的领域 设计，同时又使领域与系统其他部分保持松散耦合 </p>
<h3 id="ENITY（实体）"><a href="#ENITY（实体）" class="headerlink" title="ENITY（实体）"></a>ENITY（实体）</h3><p>主要由标识定义的对象，具有生命周期，在生命周期中它们的形式和内容可能发生变化，但必须保持一种内在的连续性。为了有效跟踪这些对象，必须定义它们的标识。</p>
<h3 id="VALUE-OBJECT（值对象）"><a href="#VALUE-OBJECT（值对象）" class="headerlink" title="VALUE OBJECT（值对象）"></a>VALUE OBJECT（值对象）</h3><p>值对象只关心是什么，而不关心它是谁</p>
<p>在领域驱动建模中，最佳实践便是将业务概念尽量建模为值对象。实体和值对象的划分并不是一成不变的，而应该根据所处的限界上下文来界定，相同一个业务名词，在一个限界上下文中可能是实体，在另外的限界上下文中可能是值对象。设计实体时，应该遵循保持实体专注于身份标识这一设计原则，让实体只承担符合它身份的业务行为，而把内聚性更强的属性分解为单独的值对象。</p>
<h3 id="SERVICE（服务）"><a href="#SERVICE（服务）" class="headerlink" title="SERVICE（服务）"></a>SERVICE（服务）</h3><p>有一些操作从概念上讲不属于任何对象，与其把它们强制归到哪一类，不如顺其自然地在模型中引入一种新元素 service</p>
<p>当我们勉强将一个操作放到不符合对象定义的对象中时，这个对象就会产生概 念上的混淆，而且会变得很难理解或重构。复杂的操作很容易把一个简单对象搞乱，使对象的角 色变得模糊。此外，由于这些操作常常会牵扯到很多领域对象——需要协调这些对象以便使它们 工作，而这会产生对所有这些对象的依赖，将那些本来可以单独理解的概念缠杂在一起。 </p>
<p>SERVICE是作为接口提供的一种操作，它在模型中是独立的，它不像ENTITY和VALUE OBJECT那样具有封装的状态。SERVICE是技术框架中的一种常见模式，但它们也可以在领域层中使用。</p>
<p>SERVICE往往是以一个活动来命名，而不是以一个ENTITY来命名，也就是 说，它是动词而不是名词。SERVICE也可以有抽象而有意义的定义，只是它使用了一种与对象不 同的定义风格。SERVICE参数和结果应该是领域对象 。</p>
<p>好的SERVICE有以下3个特征：</p>
<p>(1) 与领域概念相关的操作不是ENTITY或VALUE OBJECT的一个自然组成部分。</p>
<p>(2) 接口是根据领域模型的其他元素定义的。</p>
<p>(3) 操作是无状态的。</p>
<p>应用层SERVICE和领域层SERVICE可能很难区分 ，如果银行应用程序可以把我们的交易进行转换并导出到一个电子表格文件中，以便 进行分析，那么这个导出操作就是应用层SERVICE。文件格式在银行领域中是没有意义的，它也不涉及业务规则。<br> 账户之间的转账功能属于领域层SERVICE，因为它包含重要的业务规则(如处理相应的借方账户和贷方账户)，而资金转账是一个有意义的银行术语。在这种情况下，SERVICE 自己并不会做太多的事情，而只是要求两个Account对象完成大部分工作。但如果将转账操 作强加在Account对象上会很别扭，因为这个操作涉及两个账户和一些全局规则。</p>
<p>可以创建一个Funds Transfer(资金转账)对象来表示两个账户，外加一些与转账有关的规则和历史记录。但在银行间的网络中进行转账时，仍然需要使用SERVICE。此外，在大多数开发系统中，在一个领域对象和外部资源之间直接建立一个接口是很别扭的。我们可以利用一个FACADE(外观) 将这样的外部SERVICE包装起来，这个外观可能以模型作为输入，并返回一个 Funds Transfer对象(作为它的结果)。但无论中间涉及什么SERVICE，甚至那些超出我们掌控范围的SERVICE，这些SERVICE都是在履行资金转账的领域职责 。</p>
<p><img src="../images/image-20200515131530306.png" alt="image-20200515131530306"></p>
<h3 id="AGGREGATE-聚合"><a href="#AGGREGATE-聚合" class="headerlink" title="AGGREGATE(聚合)"></a>AGGREGATE(聚合)</h3><p>聚合是一组相关对象的集合，每个聚合有一个根（root）和边界（boundary），边界定义了聚合内部有什么，根是聚合所包含的一个特定 ENTITY。</p>
<p>对聚合来说，外部对象只能引用根，边界内部对象之间可以相互引用。除根之外的其它 ENTITY 都有本地标识，这些标识只在聚合内部才需要加以区别。</p>
<p>根可以把一个VALUE OBJEC传给另一个对象，而不用关心它发生什么变化。因为它只是一个VALUE，不再与AGGREGATE 有什么关联。</p>
<p>删除操作必须一次性删除AGGREGATE 之内的所有对象(利用垃圾收集机制，这很容易做到。由于除根以外的其他对象都没有外部引用，因此删除了根以后，其他对象均会被回收)</p>
<p>聚合根的ID在整个软件系统中全局唯一，而其下的子实体对象的ID只需在单个聚合根下唯一即可</p>
<h3 id="FACTORY（工厂）"><a href="#FACTORY（工厂）" class="headerlink" title="FACTORY（工厂）"></a>FACTORY（工厂）</h3><p>当创建一个对象或创建整个AGGREGATE时，如果创建工作很复杂，或者暴露了过多的内部结 构，则可以使用FACTORY进行封装。</p>
<p>应该将创建复杂对象的实例和AGGREGATE的职责转移给单独的对象，这个对象本身可能没有 承担领域模型中的职责，但它仍是领域设计的一部分。提供一个封装所有复杂装配操作的接口， 而且这个接口不需要客户引用要被实例化的对象的具体类。</p>
<p>不要在构造函数中调用其他类的构造函数。构造函数应该保持绝对简单。复杂的装配，特别是AGGREGATE，需要使用FACTORY。</p>
<p>REPOSITORY（仓库）</p>
<p>以通过对象之间的关联来找到对象。但当它处于生命周期的中间时，必须要有一个起 点，以便从这个起点遍历到一个ENTITY或VALUE。</p>
<p>需要一种有效的方式来获取对已存在的领域对象的引用。如果基础设施提供了这方面的 便利，那么开发人员可能会增加很多可遍历的关联，这会使模型变得非常混乱。另一方面，开发 人员可能使用查询从数据库中提取他们所需的数据，或是直接提取具体的对象，而不是通过 AGGREGATE的根来得到这些对象。这样就导致领域逻辑进入查询和客户代码中，而ENTITY和 VALUE OBJECT则变成单纯的数据容器。采用大多数处理数据库访问的技术复杂性很快就会使客 户代码变得混乱，这将导致开发人员简化领域层，最终使模型变得无关紧要。</p>
<p>除了通过根来遍历查找对象 这种方法以外，禁止用其他方法对AGGREGATE内部的任何对象进行访问。随意的数据库查询会破坏领域对象的封装和 AGGREGATE。技术基础设施和数据库访问机制的暴露会增加客户的复杂度，并妨碍模型驱动的 设计。</p>
<p>REPOSITORY将某种类型的所有对象表示为一个概念集合(通常是模拟的)。它的行为类似于 集合(collection)，只是具有更复杂的查询功能。在添加或删除相应类型的对象时， REPOSITORY 的后台机制负责将对象添加到数据库中，或从数据库中删除对象。这个定义将一组紧密相关的职 责集中在一起，这些职责提供了对AGGREGATE根的整个生命周期的全程访问。只为那些确实需要直接访问的AGGREGATE根提供REPOSITORY。 让客户始终聚焦于模型，而将所有对象的存储和访问操作交给REPOSITORY来完成。</p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2020/01/15/Storm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/01/15/Storm/" class="post-title-link" itemprop="url">Storm</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-01-15 16:52:04" itemprop="dateCreated datePublished" datetime="2020-01-15T16:52:04+08:00">2020-01-15</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-01-18 18:20:58" itemprop="dateModified" datetime="2020-01-18T18:20:58+08:00">2020-01-18</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/大数据/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a></span>

                
                
              
            </span>
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <p>Storm 是一个开源的分布式、实时、可扩展、容错的计算系统，Storm 可以可靠地处理无限数据流，像 MapReduce 和 Spark 批量处理离线数据一样。可用于实时分析、在线机器学习、连续计算、分布式 RPC、ETL 等。</p>
<h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><p>Storm 分布式集群主要由一个控制节点（Nimbus 节点）和多个工作节点（Supervisor节点）组成。</p>
<p>Zookeeper负责Nimbus 和Supervisor 节点之间的协调工作</p>
<p><img src="/images/image-20200117105814354.png" alt="image-20200117105814354"></p>
<p>Nimbus节点负责资源分配和任务分配，通过Zookeeper监控Supervisor状态，Supervisor节点定期接受Nimbus节点分配任务，并会从Nimbus下载代码，启动对应的worker进程并监控worker 状态，每一worker是一个独立的JVM进程，Worker中运行Spout/Bolt线程Task任务，Storm使用zookeeper来协调整个集群，状态信息（Nimbus分发的任务、Supervisor、worker的心跳等）都保存在Zookeeper上。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="https://blog.csdn.net/congcong68/article/details/73009054" target="_blank" rel="noopener">Storm（一） ：基础知识</a></li>
<li><a href="https://blog.chih.me/Setting-up-a-Storm-Cluster.html" target="_blank" rel="noopener">Storm 本地环境搭建</a></li>
</ol>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2020/01/02/评估指标/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/01/02/评估指标/" class="post-title-link" itemprop="url">评估指标</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-01-02 15:05:14" itemprop="dateCreated datePublished" datetime="2020-01-02T15:05:14+08:00">2020-01-02</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-01-08 11:14:58" itemprop="dateModified" datetime="2020-01-08T11:14:58+08:00">2020-01-08</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a></span>

                
                
              
            </span>
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h2 id="准确率和召回率"><a href="#准确率和召回率" class="headerlink" title="准确率和召回率"></a>准确率和召回率</h2><p><img src="/images/image-20200102150951738.png" alt="image-20200102150951738"></p>
<p>$F1=(2<em>P</em>R)/(P+R)$</p>
<p>￼￼<img src="/images/image-20200102150609551.png" alt="image-20200102150609551"></p>
<h2 id="ROC-和-AUC"><a href="#ROC-和-AUC" class="headerlink" title="ROC 和 AUC"></a>ROC 和 AUC</h2><p>很多学习器是为测试样本产生一个实值或概率预测，然后将这个预测值与分类阈值进行比较，如果大于阈值为正例，反之为负例。根据这个预测值（概率预测结果），可以将测试样本进行排序，最可能是正例的排在最前面，最不可能是正例的排在最后面。</p>
<p>在不同应用中，可根据任务需求采用不同截断点，如果更重视准确率，可选择排序中靠前的位置进行截断，如果更重视召回率，可选择靠后的位置进行截断。</p>
<p>ROC受试者工作特征（Receiver Operating Characteristic）曲线，与 P-R曲线使用准确率和召回率为纵、横坐标不同，ROC 曲线的纵轴是真正例率（True Positive Rate，TPR），横轴是假正例率（False Positive Rate，FPR）。</p>
<p>$TPR = \cfrac{TP} {TP + FN}$</p>
<p>$FPR = \cfrac{FP} {FP + TN}$</p>
<p>ROC 曲线绘制过程：给定 m 个正例和 n 个反例，根据学习器预测结果对样例进行排序，然后把分类阈值设为最大，即把所有样例均预测为反例，此时 TPR 和 FPR 都是 0，在坐标（0，0）处标记一个点，然后将分类阈值依次设为每个样例的预测值，即依次将每个样例划分为正例。设前一个标记点坐标是（x，y），当前如果是正例，则对应标记点的坐标为（x, y + 1/m）; 当前如果是假正例，对应标记点为(x + 1/n，y)，然后用线段连接相邻点即可。</p>
<p>AUC（Area Under ROC Curve）可通过对 ROC 曲线下各部分的面积求和而得。</p>
<p>准确率(accuracy) = 预测对的/所有 = (TP+TN)/(TP+FN+FP+TN)<br>精确率(precision) = TP/(TP+FP)<br>召回率(recall) = TP/(TP+FN) </p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>《机器学习》周志华</li>
</ol>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2019/12/10/Bert/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/12/10/Bert/" class="post-title-link" itemprop="url">Bert</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-12-10 16:29:49" itemprop="dateCreated datePublished" datetime="2019-12-10T16:29:49+08:00">2019-12-10</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-12-30 19:09:48" itemprop="dateModified" datetime="2019-12-30T19:09:48+08:00">2019-12-30</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/AI/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a></span>

                
                
              
            </span>
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <p>目前大部分 NLP 任务深度学习任务中都会使用预训练好的词向量（Word2Vec等）进行网络初始化（而非随机初始化），从而加快网络的收敛速度。预训练词向量通常只编码词汇之间的关系，对上下文信息考虑不足，并且无法处理一词多义问题。如 bank 既可以表示银行，也可以表示岸边，却对应相同的词向量，这显然是不合理的。为了更好地考虑词上下文信息，Context2Vec 使用两个双向长短时记忆网络（Long Short Term Memory， LSTM）来分别编码单词左到右（Left to right），右到左（right to left）的上下文信息。这种使用预训练语言模型的词向量作为特征输入到下游目标任务的方法称为 feature-based。</p>
<p>另一种方法是微调（Fine-tuning），GPT、BERT 和后续预训练工作都属于这一范畴，直接在深层 Transformer 网络上进行语言模型训练，收敛后针对下游目标进行微调，不需要再为目标任务设计 Task-specific 网络重头训练。</p>
<p>BERT（Bidirectional Encoder Representations from Transformers）是基于 Transformer 的深度双向语言表征模型，本质上利用 Transformer 结构构造了一个多层双向的 Encoder 网络。Transformer 是 Google 2017 年提出的基于自注意力机制（self-attention）的深层模型，在包括机器翻译在内的多项 NLP 任务上效果显著，超过 RNN 且训练速度更快。不到一年时间内，Transformer已经取代RNN成为神经网络机器翻译的State-Of-The-Art（SOTA）模型。</p>
<h2 id="输入表示"><a href="#输入表示" class="headerlink" title="输入表示"></a>输入表示</h2><p>针对不同的任务，BERT模型的输入可以是单句或者句对。对于每一个输入的Token，它的表征由其对应的词表征（Token Embedding）、段表征（Segment Embedding）和位置表征（Position Embedding）相加产生。</p>
<ul>
<li>对于英文模型，使用了Wordpiece模型来产生Subword从而减小词表规模；对于中文模型，直接训练基于字的模型。</li>
<li>模型输入需要附加一个起始Token，记为[CLS]，对应最终的Hidden State（即Transformer的输出）可以用来表征整个句子，用于下游的分类任务。</li>
<li>模型能够处理句间关系。为区别两个句子，用一个特殊标记符[SEP]进行分隔，另外针对不同的句子，将学习到的Segment Embeddings 加到每个Token的Embedding上。</li>
<li>对于单句输入，只有一种Segment Embedding；对于句对输入，会有两种Segment Embedding。</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="https://www.cnblogs.com/rucwxb/p/10277217.html" target="_blank" rel="noopener"><a href="https://www.cnblogs.com/rucwxb/p/10277217.html" target="_blank" rel="noopener">【NLP】彻底搞懂BERT</a></a></li>
<li><a href="https://tech.meituan.com/2019/11/14/nlp-bert-practice.html" target="_blank" rel="noopener"><a href="https://tech.meituan.com/2019/11/14/nlp-bert-practice.html" target="_blank" rel="noopener">美团BERT的探索和实践</a></a></li>
</ol>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2019/11/27/数据库设计/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/11/27/数据库设计/" class="post-title-link" itemprop="url">数据库设计</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-27 17:34:29 / 修改时间：17:53:41" itemprop="dateCreated datePublished" datetime="2019-11-27T17:34:29+08:00">2019-11-27</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/存储/" itemprop="url" rel="index"><span itemprop="name">存储</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/存储/RDBMS/" itemprop="url" rel="index"><span itemprop="name">RDBMS</span></a></span>

                
                
              
            </span>
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <p>数据库设计三范式</p>
<p>第一范式（1NF）：原子性，数据不可再分，表中每一列不可再分</p>
<p>第二范式（2NF）：唯一性，消除部分依赖，每行数据具有唯一性。在第一范式基础上，每个表必须有主键，并且没有包含在主键中的列完全依赖主键，而不能部分依赖主键。如果存在部分依赖，这些属性和关键字应该分离出来形成一个新的实体。不满足第二范式的设计容易产生冗余数据。</p>
<p>第三范式（3NF）：独立性，消除传递依赖。在满足第二范式的基础上，非主键列必须直接依赖主键，不能存在传递依赖。</p>
<p>区分第二范式还是第三范式：2NF非主键列是完全依赖主键还是依赖主键的一部分，3NF 非主键列是直接依赖主键还是直接依赖非主键列。</p>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><p>1.<a href="https://blog.csdn.net/dream_angel_z/article/details/45175621" target="_blank" rel="noopener">数据库（第一范式，第二范式，第三范式）</a></p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2019/11/26/问题整理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/11/26/问题整理/" class="post-title-link" itemprop="url">问题整理</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-26 13:02:03" itemprop="dateCreated datePublished" datetime="2019-11-26T13:02:03+08:00">2019-11-26</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-01-02 11:13:47" itemprop="dateModified" datetime="2020-01-02T11:13:47+08:00">2020-01-02</time>
              </span>
            
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <ol>
<li>什么是僵死进程，什么时候出现</li>
</ol>
<p>子进程退出时，父进程没有对子进程发出的 SIGCHLD 信号进行适当处理（waitpid或忽略），导致子进程停留在僵死状态等待父进程收尸，这种状态下的子进程称为僵死进程。</p>
<p>如果进程父进程不调用 wait / waitpid，那么保留的子进程信息（进程号，退出状态，运行时间等）不会释放，进程号会一致占用。由于系统的进程号是有限的，如果产生大量僵死进程，可能出现没有可用进程号，导致系统无法创建新的进程。</p>
<p>如何清除：</p>
<p>①改写父进程，</p>
<p>②把父进程杀掉，僵死进程成为孤儿进程，过继给 1 号进程 init，init 始终会负责清理僵死进程</p>
<ol start="2">
<li>什么是孤儿进程</li>
</ol>
<p>父进程退出后，它的子进程还在运行，这些子进程将成为孤儿进程。孤儿进程将被 init 进程（进程 id 为 1）收养，并由 init 进程对它们进程状态收集工作。</p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2019/10/22/Dubbo原理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/10/22/Dubbo原理/" class="post-title-link" itemprop="url">Dubbo原理</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-10-22 11:26:16" itemprop="dateCreated datePublished" datetime="2019-10-22T11:26:16+08:00">2019-10-22</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-01-09 22:10:17" itemprop="dateModified" datetime="2020-01-09T22:10:17+08:00">2020-01-09</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/分布式/" itemprop="url" rel="index"><span itemprop="name">分布式</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/分布式/Dubbo/" itemprop="url" rel="index"><span itemprop="name">Dubbo</span></a></span>

                
                
              
            </span>
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <p>RPC（Remote Procedure Cll）远程过程调用是从一台机器（客户端）上通过参数传递的方式调用另一台机器（服务器）上的一个函数或方法并得到返回结果。</p>
<p>备注：本文源码分析基于dubbo-2.6.4</p>
<h2 id="总体架构"><a href="#总体架构" class="headerlink" title="总体架构"></a>总体架构</h2><p><img src="/images/image-20191203150843596.png" alt="image-20191203150843596"></p>
<h2 id="请求流程"><a href="#请求流程" class="headerlink" title="请求流程"></a>请求流程</h2><ol>
<li>服务消费者（client 客户端）以调用本地服务的方式调用需要消费的服务</li>
<li>客户端存根（client stub）接收到调用请求后负责将方法、入参等信息序列化成能够进行网络传输的消息体</li>
<li>客户端存根（client stub）找到远程服务地址，将消息通过网络发送给服务端</li>
<li>服务端存根（server stub）收到消息后进行解码（反序列化）</li>
<li>服务端存根（server stub）根据解码结果调用本地服务进行相关处理（解码后请求转发给分发器 Dispatcher，Dispatcher 将请求派发到指定线程池）</li>
<li>本地服务执行具体业务逻辑将处理结果返回给服务端存根（server stub）</li>
<li>服务端存根（server stub）将返回结果打包成消息（序列化）并通过网络发送给消费方</li>
<li>客户端存根（client stub）接收到消息，进行反序列化</li>
<li>服务消费方得到最终结果（根据调用编号从 ConcurrentHashMap 中移除 DefaultFuture 对象并唤醒用户线程（signal/await））</li>
</ol>
<p>Dubbo 支持同步和异步两种调用方式，其中异步调用还可以细分为有返回值和无返回值两种。无返回值时，服务消费方只管调用不关心调用结果，Dubbo 返回一个空的 RpcResult。默认为同步方式。</p>
<p>Dubbo 实现同步和异步调用（DubboInvoker.doInvoke()）关键点在于由谁调用 ResponseFuture 的 get 方法，同步调用模式下，由框架自身调用 FeatureResponse 的 get 方法。异步调用模式下，由用户调用该方法。</p>
<h2 id="网络通信"><a href="#网络通信" class="headerlink" title="网络通信"></a>网络通信</h2><p>Dubbo 默认使用 Netty 作为底层通信框架，其它可用框架包括 Mina</p>
<h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><h2 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h2><p>Dubbo 对服务消费者的调用请求进行分配，避免少数服务提供者负载过大，将负载均衡到每个服务提供者上。</p>
<p>Dubbo 提供了 4 种负载均衡实现：</p>
<p>RandomLoadBalance 基于权重随机算法（默认负载均衡算法）</p>
<p>LeastActiveLoadBalance 基于最少活跃调用数算法</p>
<p>ConsistentHashLoadBalance 基于一致性 Hash</p>
<p>RoundRobinLoadbalance 基于加权轮询算法</p>
<h2 id="集群容错"><a href="#集群容错" class="headerlink" title="集群容错"></a>集群容错</h2><p>集群 Cluster 的用途是将多个服务提供者合并为一个 Cluster Invoker，并将这个 Invoker 暴露给服务消费者。</p>
<p>服务消费者只需要通过这个 Invoker 调用即可，至于具体调用哪个服务提供者以及调用失败后如何处理等问题，都交给集群模块处理。</p>
<p>Cluster 工作过程分为两个阶段，第一个阶段在消费者初始化期间，CLuster 实现类为消费者创建 Cluster Invoker 实例。第二阶段在消费者远程调用时，首先调用 Directory 的 list 方法列举 Invoker 列表。Directory 的用途是保存 Invoker，可简单类比为 <code>List&lt;Invoker&gt;</code>，其实现类 RegisterDirectory 是一个动态服务目录，可感知注册中心配置的变化，所持有的 Invoker 列表会随着注册中心内容的变化而变化。当 ClusterInvoker 拿到 Directory 返回的 Invoker 列表后，通过 LoadBalance 从 Invoker 列表中选择一个 Invoker。最后 ClusterInvoker 将参数传递给 Loadbalance 选出的 Invoker 方法，进行真正的远程调用。</p>
<p>Dubbo 提供了五种容错方案：</p>
<ol>
<li>Failover：失败自动切换，默认配置，调用失败后自动切换 Invoker 进行重试</li>
<li>Failfast：快速失败，只进行一次调用，失败后立即抛出异常，适用于幂等操作</li>
<li>Failsafe：失败安全，调用出现异常时，仅打印异常，不会抛出异常，适用于写入审计日志等操作</li>
<li>Failback：失败自动恢复，调用失败后返回一个空结果给客户端，通过定时任务对失败的调用进行重传，适用于消息通知等操作</li>
<li>Forking：并行调用多个服务提供者，运行时通过线程池创建多个线程，并发调用多个服务提供者，只要有一个服务提供者成功返回结果，doInvoker 方法立即结束运行。适用于实时性要求较高的读场景，会耗费更多资源</li>
<li>Broadcast：逐个调用每个服务提供者，如果其中一台报错，在循环调用结束后抛出异常。适用于通知所有提供者更新缓存或日志等本地资源</li>
</ol>
<h2 id="降级"><a href="#降级" class="headerlink" title="降级"></a>降级</h2><p>熔断用于调用下游服务连续失败时，开启熔断器，之后的服务不再调用下游服务，要么返回失败要么降级，直到满足熔断器关闭策略后才再次调用下游。</p>
<p>Dubbo 中通过对接口或方法配置 Mock 参数来设置对应的降级实现。具体实现在MockClusterInvoker类中。</p>
<p>降级分 no mock（无降级，直接调用）、force:direct mock（屏蔽，直接调用 mock 方法）、fail-mock（容错，原接口调用失败后走容错逻辑，可返回 null、默认值或降级服务）三种情况。</p>
<p>Dubbo 本身没有熔断器，需要自己实现或整合 Sentinel 或 Hystrix </p>
<h2 id="优雅停机"><a href="#优雅停机" class="headerlink" title="优雅停机"></a>优雅停机</h2><p>优雅停机是指在停止应用时，执行的一系列保证应用正常关闭的操作。这些操作往往包括等待已有请求执行完成、关闭线程、关闭连接和释放资源等，优雅停机可以避免非正常关闭程序可能造成数据异常或丢失，应用异常等问题。优雅停机本质上是JVM即将关闭前执行的一些额外的处理代码。</p>
<h3 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h3><ul>
<li>JVM主动关闭(<code>System.exit(int)</code>；</li>
<li>JVM由于资源问题退出(<code>OOM</code>)；</li>
<li>应用程序接受到<code>SIGTERM</code>或<code>SIGINT</code>信号。</li>
</ul>
<p>在Dubbo中，优雅停机是默认开启的，停机等待时间为10000毫秒。可以通过配置<code>dubbo.service.shutdown.wait</code>来修改等待时间。</p>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><p>Provider在接收到停机指令后</p>
<ul>
<li>从注册中心上注销所有服务；</li>
<li>从配置中心取消监听动态配置；</li>
<li>向所有连接的客户端发送只读事件，停止接收新请求；</li>
<li>等待一段时间以处理已到达的请求，然后关闭请求处理线程池；</li>
<li>断开所有客户端连接。</li>
</ul>
<p>Consumer在接收到停机指令后</p>
<ul>
<li>拒绝新到请求，直接返回调用异常；</li>
<li>等待当前已发送请求执行完毕，如果响应超时则强制关闭连接。</li>
</ul>
<p>当使用容器方式运行 Dubbo 时，在容器准备退出前，可进行一系列的资源释放和清理工。</p>
<p>例如使用 SpringContainer时，Dubbo 的ShutdownHook线程会执行<code>ApplicationContext</code>的<code>stop</code>和<code>close</code>方法，保证 Bean的生命周期完整。</p>
<p>配置的优雅停机等待时间<code>timeout</code>不是所有步骤等待时间的总和，而是每一个<code>destroy</code>执行的最大时间。例如配置等待时间为5秒，则关闭Server、关闭Client等步骤会分别等待5秒。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="https://dubbo.apache.org/zh-cn/docs/user/preface/architecture.html" target="_blank" rel="noopener">Dubbo 官方文档</a></li>
<li><a href="https://juejin.im/post/5cd28d1ee51d453aa44ad6d8" target="_blank" rel="noopener">看了这篇Dubbo RPC面试题，让天下没有难面的面试题</a></li>
<li><a href="https://zhouj000.github.io/2019/02/18/dubbo-03/" target="_blank" rel="noopener">Dubbo(三):高并发下降级与限流</a></li>
<li><a href="https://www.jianshu.com/p/ce8de35986cf" target="_blank" rel="noopener">dubbo的Mock功能与源码实现</a></li>
<li><a href="https://www.cnblogs.com/wuzhenzhao/p/11496627.html" target="_blank" rel="noopener">Sentinel之熔断降级</a></li>
<li><a href="https://dubbo.apache.org/zh-cn/blog/dubbo-gracefully-shutdown.html" target="_blank" rel="noopener">Dubbo 优雅停机</a></li>
<li><a href="https://www.cnkirito.moe/rpc-dynamic-proxy/" target="_blank" rel="noopener">深入理解 RPC 之动态代理篇</a></li>
</ol>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2019/10/17/synchronized/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/10/17/synchronized/" class="post-title-link" itemprop="url">Java并发面试题整理</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-10-17 19:57:44" itemprop="dateCreated datePublished" datetime="2019-10-17T19:57:44+08:00">2019-10-17</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-12-20 13:07:53" itemprop="dateModified" datetime="2019-12-20T13:07:53+08:00">2019-12-20</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/并发/" itemprop="url" rel="index"><span itemprop="name">并发</span></a></span>

                
                
              
            </span>
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <p>背景知识</p>
<p>CPU 指令：CPU 的一些指令是非常危险的，误用可能导致严重后果，如清理内存、设置时钟等。Intel 将 CPU 指令分为4 个级别，RING0,RING1,RING2,RING3。Linux 使用 RING3级别运行用户态，RING0运行内核态。RING3 不能访问 RING0 的RING0 的地址空间，包括代码和数据。当用户态程序要执行文件操作、发送数据等操作时，需要通过 write、send 等系统调用，这些系统调用会调用内核中的代码来完成操作，必须切换到 RING0，完成后切换回 RING3，这样用户态程序就不能随意操作内核地址空间，有一定的安全保护作用。</p>
<p>从用户态到内核态有两种触发手段：</p>
<ol>
<li>用户空间的应用程序通过提醒调用进入内核空间，用户空间进程将参数传递给内核，内核空间运行时也需要保存用户进程的寄存器、变量等。“进程上下文”可以看做用户进程传递给内核的参数、内核要保存的变量、寄存器和当时的环境等。</li>
<li>硬件通过触发信号，导致内核调用中断处理程序，进入内核空间。硬件的变量和参数也要传递给内核，内核通过这些参数进行中断处理。“中断上下文”可以看做硬件传递过来的参数和内核需要保存的环境。</li>
</ol>
<h2 id="Synchronized"><a href="#Synchronized" class="headerlink" title="Synchronized"></a>Synchronized</h2><p><strong>synchronized 同步语句块的实现使用的是 monitorenter 和 monitorexit 指令，其中 monitorenter 指令指向同步代码块的开始位置，monitorexit 指令则指明同步代码块的结束位置。</strong> 当执行 monitorenter 指令时，线程试图获取锁也就是获取 monitor(monitor对象存在于每个Java对象的对象头中，synchronized 锁便是通过这种方式获取锁的，也是为什么Java中任意对象可以作为锁的原因) 的持有权。当计数器为0则可以成功获取，获取后将锁计数器设为1也就是加1。相应的在执行 monitorexit 指令后，将锁计数器设为0，表明锁被释放。如果获取对象锁失败，那当前线程就要阻塞等待，直到锁被另外一个线程释放为止。</p>
<p>synchronized 同步方法比普通方法多了 ACC_SYNCHRONIZED 标识，JVM 根据这个标识实现同步。调用方法时先检查是否有 ACC_SYNCHRONIZED标识，有的话线程先获取 monitor，获取成功才继续执行方法，方法执行完成后线程再释放 monitor，同一个 monitor 同一时刻只能被一个线程拥有。</p>
<p>两种方式都通过 monitor 来实现同步，monitor 的实现依赖底层操作系统的 mutex 互斥原语，操作系统实现线程之间的切换需要从用户态转到内核态，切换成本较大。</p>
<p>wait、notify 和 notifyAll 也依赖于 monitor 对象来完成的，所以要在同步方法或同步代码块中调用的原因（需要先获取对象的锁，才能执行）否则抛出 IllegalMonitorStateException 异常。</p>
<p><strong>jdk1.6之后 synchronized 优化</strong></p>
<p>重量级锁的实现基于操作系统的 mutex互斥原语，开销较大。JVM 对 synchronized 做了优化，先利用对象头实现锁的功能，如果线程竞争过大则将锁升级（膨胀）为重量级锁，也就是使用 monitor 对象。锁主要存在四种状态，依次是：无锁状态、偏向锁状态、轻量级锁状态、重量级锁状态，他们会随着竞争的激烈而逐渐升级。注意锁可以升级不可降级，这种策略是为了提高获得锁和释放锁的效率。这几个锁只有重量级锁需要操作系统底层 mutex 互斥原语实现，其它锁都使用对象头来实现。锁可以升级，但不能降级。</p>
<ol>
<li>偏向锁：偏向锁在无竞争情况下把整个同步都消除掉，连 CAS 都不做。锁对象第一次被线程获取时，虚拟机将对象头中的标志位设为“01”，即偏向模式（JVM 参数可配置），同时使用 CAS 把获取到这个锁的线程 ID 记录在对象的 Mark Word 中，如果 CAS 操作成功，持有偏向锁的线程以后每次进入这个锁相关的同步块，虚拟机都不再进行任何同步操作（Locking、Unlocking、对 Mark Word 的 update 等）。当其它线程尝试获取这个锁时，偏向模式结束，恢复到未锁定（标志位 01）或轻量级锁定（标志位 00）的状态，后续按轻量级锁执行。</li>
<li>轻量级锁：在没有多线程竞争的前提下，减少传统重量级锁使用互斥量产生的性能消耗，因为使用轻量级锁时，不需要申请互斥量，轻量级锁的加锁和解锁都使用 CAS 操作，如果有两条以上的线程争用同一个锁，轻量级锁直接膨胀为重量级锁。</li>
<li>自旋锁和自适应锁：一般线程持有锁的时间都不太长，仅仅为这一天时间去挂起/恢复线程得不偿失，为了让线程等待，只需要让线程执行一个忙循环（自旋），在 jdk1.6 中引入了自适应的自旋锁，自旋时间不再固定了，而是和前一次同一个锁上的自旋时间以及锁的拥有者状态来决定。如果在同一个锁对象上，自旋等待刚刚成功获得过锁，并且持有锁的线程正在运行中，那么 JVM 认为这次自旋也很有可能再次成功，进而允许自旋等待相对更长的时间，如 100 个循环；如果很少成功过，就忽略掉自旋过程，让虚拟机变得更“聪明”</li>
<li>锁消除和锁优化</li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="https://blog.csdn.net/liuyueyue0921/article/details/48225533" target="_blank" rel="noopener">用户态和内核态</a></li>
<li><a href="https://juejin.im/post/5c936018f265da60ec281bcb" target="_blank" rel="noopener">深入分析synchronized原理和锁膨胀过程</a></li>
</ol>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2019/10/12/AQS 整理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/10/12/AQS 整理/" class="post-title-link" itemprop="url">Java并发面试题整理</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-10-12 19:57:44" itemprop="dateCreated datePublished" datetime="2019-10-12T19:57:44+08:00">2019-10-12</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-12-03 15:02:00" itemprop="dateModified" datetime="2019-12-03T15:02:00+08:00">2019-12-03</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/并发/" itemprop="url" rel="index"><span itemprop="name">并发</span></a></span>

                
                
              
            </span>
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <p>AQS 全称 AbstractQueuedSynchronizer，是 java.util.concurrent.locks 包下面的一个类。用来构建锁和同步器的框架，使用 AQS 能简单而高效地构造出应用广泛的大量同步器，如ReentrantLock，Semaphore，ReentrantrantReadWriteLock，SynchronousQueue，FutureTask 等。开发者也可以利用 AQS 构造出符合要求的同步器。</p>
<p>AQS 的核心思想是，如果被请求的共享资源空闲，则将当前请求资源的线程设置为有效的工作线程，并将共享资源设置为锁定状态。如果被请求的共享资源被占用，就需要一套线程阻塞等待以及被唤醒时锁分配的机制，这个机制 AQS 是用 CLH 队列锁实现的，即将暂时获取不到锁的线程加入到队列中。</p>
<p>CLH（Craig，Landin， and Hagersten）队列是一个虚拟的是双向队列（虚拟的双向队列即不存在队列实例，仅存在节点之间的关联关系）。AQS 是将每条共享资源的线程封装成一个 CLH 锁队列的一个结点（Node）来实现锁的分配。</p>
<p>AQS 使用一个 int 成员变量来表示同步状态，通过内置的 FIFO 队列来完成获取资源线程的排队工作。使用 CAS 对该同步状态进行原子操作实现对其值的修改。</p>
<h3 id="共享方式"><a href="#共享方式" class="headerlink" title="共享方式"></a>共享方式</h3><ol>
<li>Exclusive（独占）只有一个线程能执行，如 ReentrantLock。独占锁又分为公平锁和非公平锁。公平锁按照线程在队列中的排队顺序，先到者先获取锁；非公平锁在线程需要获取锁时，无视队列顺序直接去抢锁，谁抢到算谁的。</li>
<li>Share（共享）：多个线程可同时执行，如 Semaphore、CountDownLatch、CyclicBarrier、ReadWriteLock</li>
</ol>
<h3 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h3><p>同步器设计基于模板模式，自定义同步器一般的方式为：</p>
<ol>
<li>继承 AbstractQueuedSynchronizer 并重写指定方法，这些方法是对共享资源 state 的获取和释放</li>
<li>将 AQS 组合在自定义同步组件的实现中，并调用其它模板方法，这些模板方法会调用使用者重写的方法</li>
</ol>
<p>AQS 使用模板方法模式，自定义同步器时重写以下几个 AQS 提供的模板方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">isHeldExclusively(); <span class="comment">// 线程是否在独占资源，用到 condition 时才需要实现</span></span><br><span class="line">tryAcquire(<span class="keyword">int</span>);<span class="comment">// 独占方式，尝试获取资源，成功则返回 true，失败则返回 false</span></span><br><span class="line">tryRelease(<span class="keyword">int</span>);<span class="comment">// 独占方式，尝试释放资源，成功则返回 true，失败则返回 false</span></span><br><span class="line">tryAcquireShared(<span class="keyword">int</span>);<span class="comment">// 共享方式，尝试获取资源，负数表示失败；0 表示成功，但没有剩余可获取资源；正数表示成功，并且有可用资源</span></span><br><span class="line">tryReleaseShared(<span class="keyword">int</span>);<span class="comment">// 共享方式，尝试释放资源成功返回 true，失败返回 false</span></span><br></pre></td></tr></table></figure>

<p>默认情况下，每个方法都抛出<code>UnsupportedOperationException</code>，这些方法的实现必须是线程安全，并且应该简短而不阻塞。AQS 中的其它方法都是 final的，无法被其它类使用。</p>
<h3 id="CyclicBarrier-和-CountDownLatch-的区别"><a href="#CyclicBarrier-和-CountDownLatch-的区别" class="headerlink" title="CyclicBarrier 和 CountDownLatch 的区别"></a>CyclicBarrier 和 CountDownLatch 的区别</h3><p>CountDownlatch 是计数器，只能使用一次，计数为 0 时释放所有等待线程；CyclicBarrier 的计数器提供 reset 功能，可以使用多次。</p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jeffzzf.github.io/2019/09/24/生产者消费者问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jeffzzf">
      <meta itemprop="description" content="Do one thing at a time, and do well.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Noob">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/09/24/生产者消费者问题/" class="post-title-link" itemprop="url">生产者消费者问题</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-09-24 14:14:31" itemprop="dateCreated datePublished" datetime="2019-09-24T14:14:31+08:00">2019-09-24</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-10-16 18:03:42" itemprop="dateModified" datetime="2019-10-16T18:03:42+08:00">2019-10-16</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/并发/" itemprop="url" rel="index"><span itemprop="name">并发</span></a></span>

                
                
              
            </span>
          

          <br>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <p>生产者消费者问题中，生产者生产数据，消费者消费数据。为了解藕生产者和消费者的关系，通常会采用共享的数据区域，生产者生产数据后直接放在共享数据区，不需要关心消费者的行为；消费者只需要从共享区中获取数据，不需要关心生产者的行为。共享数据区应具备线程间并发协作的能力：</p>
<ol>
<li>如果共享数据区已满，阻塞生产者继续生产数据放置到数据区</li>
<li>如果共享数据区为空，阻塞消费者继续消费数据</li>
</ol>
<p>实现生产者消费者问题可以采用三种方法：</p>
<ol>
<li>用Object的wait/notify消息通知机制</li>
<li>用Lock的Condition的wait/signal消息通知机制</li>
<li>用BlockingQueue实现</li>
</ol>
<h2 id="wait-notify实现"><a href="#wait-notify实现" class="headerlink" title="wait/notify实现"></a>wait/notify实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ExecutorService executor = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">8</span>, <span class="number">8</span>, <span class="number">300</span>,</span><br><span class="line">                TimeUnit.MILLISECONDS, <span class="keyword">new</span> ArrayBlockingQueue&lt;Runnable&gt;(<span class="number">8</span>), <span class="keyword">new</span> ThreadPoolExecutor.DiscardPolicy());</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            executor.submit(<span class="keyword">new</span> Consumer(list));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            executor.submit(<span class="keyword">new</span> Producer(list, <span class="number">10</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!executor.isTerminated()) &#123;</span><br><span class="line">            ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> maxLength;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(List&lt;String&gt; list, <span class="keyword">int</span> maxLength)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.list = list;</span><br><span class="line">            <span class="keyword">this</span>.maxLength = maxLength;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">synchronized</span>(list) &#123;</span><br><span class="line">                        <span class="keyword">while</span>(list.size() &gt; maxLength) &#123;</span><br><span class="line">                            list.wait();</span><br><span class="line">                        &#125;</span><br><span class="line">                        list.add(Thread.currentThread().getName());</span><br><span class="line">                        list.notifyAll();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(List&lt;String&gt; list)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.list = list;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">synchronized</span> (list) &#123;</span><br><span class="line">                        <span class="keyword">while</span> (list.isEmpty()) &#123;</span><br><span class="line">                            list.wait();</span><br><span class="line">                        &#125;</span><br><span class="line">                        System.out.println(list.remove(<span class="number">0</span>));</span><br><span class="line">                        list.notifyAll();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Lock-Condition实现"><a href="#Lock-Condition实现" class="headerlink" title="Lock/Condition实现"></a>Lock/Condition实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testProducerConsumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;String&gt; list = Lists.newArrayList();</span><br><span class="line">        ReentrantLock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line">        Condition full = lock.newCondition();</span><br><span class="line">        Condition empty = lock.newCondition();</span><br><span class="line"></span><br><span class="line">        ExecutorService executor = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">8</span>, <span class="number">8</span>, <span class="number">30</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                <span class="keyword">new</span> ArrayBlockingQueue&lt;Runnable&gt;(<span class="number">1</span>), <span class="keyword">new</span> ThreadPoolExecutor.DiscardPolicy());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            executor.submit(<span class="keyword">new</span> Producer(list, <span class="number">100</span>, lock, full, empty));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            executor.submit(<span class="keyword">new</span> Consumer(list, lock, full, empty));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!executor.isTerminated()) &#123;</span><br><span class="line">            ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line">        <span class="keyword">private</span> Lock lock;</span><br><span class="line">        <span class="keyword">private</span> Condition full;</span><br><span class="line">        <span class="keyword">private</span> Condition empty;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(List&lt;String&gt; list, Lock lock, Condition full, Condition empty)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.list = list;</span><br><span class="line">            <span class="keyword">this</span>.lock = lock;</span><br><span class="line">            <span class="keyword">this</span>.full = full;</span><br><span class="line">            <span class="keyword">this</span>.empty = empty;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    lock.lock();</span><br><span class="line">                    <span class="keyword">while</span> (list.isEmpty()) &#123;</span><br><span class="line">                        empty.await();</span><br><span class="line">                    &#125;</span><br><span class="line">                    String element = list.remove(<span class="number">0</span>);</span><br><span class="line">                    System.out.println(element);</span><br><span class="line">                    full.signalAll();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    lock.unlock();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line">        <span class="keyword">private</span> Integer maxLength;</span><br><span class="line">        <span class="keyword">private</span> Random random;</span><br><span class="line">        <span class="keyword">private</span> Lock lock;</span><br><span class="line">        <span class="keyword">private</span> Condition full;</span><br><span class="line">        <span class="keyword">private</span> Condition empty;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(List&lt;String&gt; list, <span class="keyword">int</span> maxLength, Lock lock, Condition full, Condition empty)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.list = list;</span><br><span class="line">            <span class="keyword">this</span>.lock = lock;</span><br><span class="line">            <span class="keyword">this</span>.maxLength = maxLength;</span><br><span class="line">            <span class="keyword">this</span>.random = <span class="keyword">new</span> Random(System.currentTimeMillis());</span><br><span class="line">            <span class="keyword">this</span>.full = full;</span><br><span class="line">            <span class="keyword">this</span>.empty = empty;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    lock.lock();</span><br><span class="line">                    <span class="keyword">while</span> (list.size() &gt;= maxLength) &#123;</span><br><span class="line">                        full.await();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">double</span> d = random.nextGaussian();</span><br><span class="line">                    list.add(Thread.currentThread().getName() + <span class="string">" "</span> + d);</span><br><span class="line">                    empty.signalAll();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    lock.unlock();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="BlockingQueue"><a href="#BlockingQueue" class="headerlink" title="BlockingQueue"></a>BlockingQueue</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testProducerConsumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        BlockingQueue&lt;String&gt; queue = <span class="keyword">new</span> ArrayBlockingQueue&lt;String&gt;(<span class="number">100</span>);</span><br><span class="line">        ExecutorService executor = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">8</span>, <span class="number">8</span>, <span class="number">300</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                <span class="keyword">new</span> ArrayBlockingQueue&lt;Runnable&gt;(<span class="number">10</span>), <span class="keyword">new</span> ThreadPoolExecutor.AbortPolicy());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            executor.submit(<span class="keyword">new</span> Producer(queue));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            executor.submit(<span class="keyword">new</span> Consumer(queue));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!executor.isTerminated()) &#123;</span><br><span class="line">            ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> BlockingQueue&lt;String&gt; queue;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(BlockingQueue&lt;String&gt; queue)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.queue = queue;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                queue.offer(Thread.currentThread().getName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> BlockingQueue&lt;String&gt; queue;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(BlockingQueue&lt;String&gt; queue)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.queue = queue;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                String s = queue.poll();</span><br><span class="line">                System.out.println(s);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://juejin.im/post/5aeec675f265da0b7c072c56#heading-0" target="_blank" rel="noopener">一篇文章，让你彻底弄懂生产者–消费者问题</a></p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jeffzzf</p>
  <div class="site-description motion-element" itemprop="description">Do one thing at a time, and do well.</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">121</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">60</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">107</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>



        </div>
      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jeffzzf</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.3.0</div>

        








        
      </div>
    </footer>
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
      </div>

    

  </div>

  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  <script src="/js/utils.js?v=7.3.0"></script>
  <script src="/js/motion.js?v=7.3.0"></script>

  
  <script src="/js/schemes/muse.js?v=7.3.0"></script>


  

  <script src="/js/next-boot.js?v=7.3.0"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  

  

  


  





  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
































</body>
</html>
